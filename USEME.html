<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoBooking 設定</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        .container {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2 class="mb-4">個人設定</h2>
        <form id="bookingForm">
            <div class="mb-3">
                <label for="name" class="form-label">お名前 (NAME)</label>
                <input type="text" class="form-control" id="name" required>
            </div>
            <div class="mb-3">
                <label for="phone" class="form-label">電話番号 (PHONE_NUMBER)</label>
                <input type="text" class="form-control" id="phone" pattern="\d*" placeholder="ハイフン(-)なしで数字のみを入力" required>
            </div>
            <div class="mb-3">
                <label for="email" class="form-label">メールアドレス (E_MAIL)</label>
                <input type="email" class="form-control" id="email" required>
            </div>
            <div class="mb-3">
                <label for="facility" class="form-label">体育館名 (FACILITY_NAME)</label>
                <select class="form-select" id="facility" required>
                    <option value="">選択してください</option>
                    <option value="HIGASHI">HIGASHI</option>
                    <option value="KITA">KITA</option>
                    <option value="TOYANO">TOYANO</option>
                    <option value="NISHI">NISHI</option>
                    <option value="KAMEDA">KAMEDA</option>
                </select>
            </div>
            <div class="mb-3">
                <label for="time" class="form-label">時間帯 (TIME)</label>
                <select class="form-select" id="time" required>
                    <option value="">選択してください</option>
                    <option value="9-11">9-11</option>
                    <option value="11-13">11-13</option>
                    <option value="13-15">13-15</option>
                    <option value="15-17">15-17</option>
                    <option value="17-19">17-19</option>
                    <option value="19-21">19-21</option>
                </select>
            </div>
            <div class="mb-3">
                <label for="court" class="form-label">コート数 (COURT_NO)</label>
                <input type="number" class="form-control" id="court" min="1" max="3" value="1" required>
            </div>
            <button type="submit" class="btn btn-primary">設定保存</button>
        </form>
    </div>

    <script>
        document.getElementById('bookingForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // remove hyphens from phone number
            const phone = document.getElementById('phone').value.replace(/-/g, '');
            
            const data = {
                NAME: document.getElementById('name').value,
                PHONE_NUMBER: phone,
                E_MAIL: document.getElementById('email').value,
                FACILITY_NAME: document.getElementById('facility').value,
                TIME: document.getElementById('time').value,
                COURT_NO: document.getElementById('court').value
            };

            // download JSON file
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'my_data.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        });

        // limit phone number input to digits only
        document.getElementById('phone').addEventListener('input', function(e) {
            this.value = this.value.replace(/[^0-9]/g, '');
        });

        // limit number of court between 1 and 3
        document.getElementById('court').addEventListener('change', function(e) {
            const value = parseInt(this.value);
            if (value < 1) this.value = 1;
            if (value > 3) this.value = 3;
        });
    </script>
</body>
</html>